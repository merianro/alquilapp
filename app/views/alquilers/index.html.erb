<p style="color: green"><%= notice %></p>
<div class="container-fluid justify-content-center">
  <h1>Alquileres</h1>
  <div class="table-responsive">
  <table class="table table-hover">
  <thead class="table-light">
    <tr>
      <th class="text-center">Fecha</th>
      <th class="text-center">Patente del Vehículo</th>
       <% if !current_user.driver?%>  
      <th class="text-center">DNI Usuario</th>
      <% end%>
      <th class="text-center">Duración</th>
      <th class="text-center">Fecha de finalización</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% if current_user.admin? || current_user.su? %>
    <% @alquilers.order(:created_at).each do |alquiler| %>
      <tr>
        <td class="text-center">
          <%=h alquiler.created_at.gmtime - 3.hours %>
        </td>
        <td class="text-center">
          <%=h alquiler.car.patente  %>
        </td>
        <td class="text-center">
          <%=h alquiler.user.dni %>
        </td>
        <td class="text-center">
          <%=h alquiler.horas %> horas
        </td>
        <td class="text-center">
          <%=h alquiler.end_date.gmtime - 3.hours %>  
        </td>
        <td class="text-center">
          <div class="btn-group">
              <%= link_to "Ver detalle", alquiler,class:"btn btn-secondary btn-sm" %>
              <button type="button" class="btn btn-sm btn-secondary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false"></button>
                 <ul class="dropdown-menu">
                   <% if current_user.admin? then %>
                    <%= button_to "Eliminar alquiler", car,:onclick => "return confirm('Esta seguro que desea eliminar permanentemente la información relacionada al alquiler?')", method: :delete, class:"dropdown-item" %>
                   <%end%>
                 </ul>
          </div>
        </td>
      </tr>
      <% end %>
      <% else %>
      <% @alquilers.where(user_id: current_user.id).order(:created_at).each do |alquiler| %>
      <tr>
        <td class="text-center">
          <%=h alquiler.created_at.gmtime - 3.hours %>
        </td>
        <td class="text-center">
          <%=h alquiler.car.patente  %>
        </td>
        <td class="text-center">
          <%=h alquiler.horas %> horas
        </td>
         <td class="text-center">
          <%=h alquiler.end_date.gmtime  %>  
        </td>
        <td class="text-center">
          <div class="btn-group">
              <%= link_to "Ver detalle", alquiler,class:"btn btn-secondary btn-sm" %>
              <button type="button" class="btn btn-sm btn-secondary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false"></button>
                 <ul class="dropdown-menu">           
                    <%= button_to "Realizar reporte", sistema_reportes_url,:onclick => "return confirm('')", method: :delete, class:"dropdown-item" %>
                 </ul>
          </div>
        </td>
      </tr>
      <% end %>
    <% end %>
  </tbody>



</table>
</div>
